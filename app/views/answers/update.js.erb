// after saving the answer (and possibly getting a conflict)
// set the message div about the answer.
// On success this will be "" on error it will be the 
// conflicting answer

<% if @old_answer %>
  $("#answer_notice_<%=@question.id%>").html("<%= escape_javascript(render partial: '/phases/answer', locals: { question: @question, answer: @old_answer}) %>"); 
<% else %>
  $("#answer_notice_<%=@question.id%>").html(""); 
<% end %>

// have to update the lock_version on success or failure
// so that the next save can work. If you don't do
// this it will fail forever. Also update the answer id

$("#answer_lock_version-<%=@question.id%>").val(<%= @lock_version %>);
$("#question-form-<%= @question.id %> #answer_id").val(<%= @answer.id %>);

// update the answer status
$("#answer-status-<%= @question.id %>")
    .html("<%= escape_javascript(render partial: '/answers/status', locals: { question_id: @question.id, answer: @answer}) %>");
if($.fn.init_answer_status) 
    $.fn.init_answer_status();

// update plan progress bar
$(".progress").html("<%= escape_javascript(render :partial => '/plans/progress', locals: { plan: @plan }) %>"); 


// update the section progress
$("#section-progress-<%= @section.id %>")
    .html("<%= escape_javascript(render partial: '/sections/progress', locals: { section: @section, plan: @plan }) %>");