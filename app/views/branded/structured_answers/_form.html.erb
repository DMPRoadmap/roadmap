<% schema = @fragment.structured_data_schema %>
<%= form_for @fragment do |f| %>
  <div class="form-group">
      <% schema.schema['properties'].each do |key, prop| %>
          <% value = @fragment.data[key] unless @fragment.data.nil? %>
          <% case prop['type'] %>
              <% when 'string' %>
                  <%= create_text_field(f, value, key, prop['label']) %>
              <% when 'integer' %>
                  <%= create_number_field(f, value, key, prop['label']) %>
              <% when 'boolean' %>
                  <%= create_checkbox_field(f, value, key, prop['label']) %>
              <% when 'array' %>
                <%= render(partial: 'questions/fields/multiple_field', locals:
                { f: f, field_values: value,
                field_properties: prop,
                field_name: key }) %>
          <% end %>
      <% end %>
      <%= f.hidden_field :schema_id, value: schema.id %>
      <%= f.button(_('Save'), class: 'btn btn-default', type: 'submit') %>
  </div>
<% end %>