
$(() => {
  $('#modal-window').html('<%= escape_javascript(render "shared/dynamic_form/modal") %>');

  $('#modal-window').modal();


  $('#modal_fragment_form').on('ajax:success', (event, response) => {
    if (response.classname === 'research_output') {
      $('#research-outputs-list').html(response.html);
    } else if (response.source === 'list-modal') {
      const queryId = $(event.target).find('.query_id').val();
      $(`table.list-${queryId} tbody`).html(response.html);
    } else {
      const queryId = $(event.target).find('.query_id').val();
      const $select = $(`.select-${queryId} select`);
      $select.html(response.html).trigger('change');
    }
    $('#modal-window').modal('hide');
  }).on('ajax:error', () => {
    console.log('ajax:error');
  });
});
